(function(t){function e(e){for(var a,o,s=e[0],c=e[1],l=e[2],u=0,p=[];u<s.length;u++)o=s[u],r[o]&&p.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(a=!1)}a&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},r={app:0},i=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var d=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("c21b"),r=n.n(a);r.a},"0e07":function(t,e,n){"use strict";var a=n("82b7"),r=n.n(a);r.a},"1ab3":function(t,e,n){},"34ba":function(t,e,n){"use strict";var a=n("cfd9"),r=n.n(a);r.a},"3c61":function(t,e,n){},5004:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var a=n("2b0e"),r=n("8c4f"),i=n("9f7b"),o=(n("f9e3"),n("2dd8"),n("0874")),s=(n("d06d"),n("b408")),c=n.n(s);a["default"].filter("hoursMinutesSeconds",function(t){var e=parseInt(Math.floor(t/3600)),n=parseInt(Math.floor((t-3600*e)/60)),a=parseInt((t-(3600*e+60*n))%60),r=e>9?e:"0"+e,i=n>9?n:"0"+n,o=a>9?a:"0"+a;return r+":"+i+":"+o});var l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("NavBar"),n("Player")],1)},d=[],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"info",id:"navbar"}},[n("b-container",[n("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),n("b-navbar-brand",{attrs:{href:"#"}},[t._v("Video wall")]),n("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{attrs:{to:"/player"}},[t._v("Player")])],1)],1)],1)],1)},p=[],f={name:"NavBar",components:{}},v=f,m=(n("34ba"),n("2877")),b=Object(m["a"])(v,u,p,!1,null,null,null);b.options.__file="NavBar.vue";var y=b.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"videoWall"}},[n("ScreenGrid",{attrs:{clientConfig:t.serverState.client_config,clients:t.serverState.clients}}),n("center",[n("PlayerBar",{attrs:{playerState:t.serverState.player},on:{play:function(e){t.play(e)}}})],1)],1)},g=[],_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"playerBar"}},[n("PlaylistModal",{attrs:{playerState:t.playerState},on:{play:function(e){t.$emit("play",e)}}}),n("b-button-group",[n("b-button",{attrs:{variant:"outline-secondary"}},[n("v-icon",{attrs:{name:"backward"}})],1),n("b-button",{attrs:{variant:"outline-secondary",disabled:!t.playerState.current_media_filename},on:{click:function(e){t.$emit("play",t.playerState.current_media_filename)}}},[n("v-icon",{attrs:{name:"sync-alt"}})],1),n("b-button",{attrs:{variant:"outline-secondary"}},[n("v-icon",{attrs:{name:"forward"}})],1)],1),n("div",{staticClass:"playerTime"},[n("b-form-input",{attrs:{type:"text",placeholder:t._f("hoursMinutesSeconds")(t.playerState.position),disabled:""}})],1),n("div",{attrs:{id:"playerProgress"}},[n("b-progress",{attrs:{max:t.playerState.duration,variant:"info"}},[n("b-progress-bar",{attrs:{value:t.playerState.position},domProps:{textContent:t._s(t.playerState.current_media_filename)}})],1)],1),n("div",{staticClass:"playerTime"},[n("b-form-input",{attrs:{type:"text",placeholder:t._f("hoursMinutesSeconds")(t.playerState.duration),disabled:""}})],1),n("b-button-group",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.playlistModal",modifiers:{playlistModal:!0}}],attrs:{variant:"outline-secondary"}},[n("v-icon",{attrs:{name:"list-ul"}})],1)],1)],1)},S=[],x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"playlistModal","hide-footer":"",title:"Playlist"}},[n("b-list-group",t._l(t.playerState.media_filenames,function(e){return n("b-list-group-item",{key:e,staticClass:"flex-column align-items-start",attrs:{variant:t.playerState.current_media_filename==e?"info":""}},[n("div",[n("div",{staticClass:"d-flex w-100 justify-content-between"},[n("h5",{staticClass:"mb-1",domProps:{textContent:t._s(e)}}),n("b-button-group",{staticClass:"playlistVideoButtons",attrs:{size:"sm"}},[n("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(n){t.$emit("play",e)}}},[t.playerState.current_media_filename!=e?n("v-icon",{attrs:{name:"play"}}):n("v-icon",{attrs:{name:"sync-alt"}})],1),t.playerState.current_media_filename!=e?n("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(n){t.deleteMedia(e)}}},[n("v-icon",{attrs:{name:"times"}})],1):t._e()],1)],1)])])})),t.err?n("b-alert",{attrs:{variant:"danger",show:"",dismissible:""},domProps:{textContent:t._s(t.err)}}):t._e(),n("vue2-dropzone",{ref:"dropzone",attrs:{id:"dropzone",options:t.dropzoneOptions},on:{"vdropzone-file-added":function(e){t.err=""},"vdropzone-complete":function(e){t.uploadComplete(t.$refs.dropzone)},"vdropzone-error":t.uploadError}})],1)},w=[],C=(n("b012"),n("1516")),k=n.n(C),P=n("92c3"),M=n.n(P),O=(n("1e3f"),{components:{draggable:k.a,vue2Dropzone:M.a},props:{playerState:{type:Object,required:!0}},data:function(){return{dropzoneOptions:{url:"/upload",thumbnailWidth:200,maxFilesize:500},err:""}},methods:{uploadComplete:function(t){t.removeAllFiles(),this.syncMedia()},uploadError:function(t){this.err=JSON.parse(t.xhr.response).reason},deleteMedia:function(t){this.$socket.sendObj({command:"delete",arguments:{filename:t}}),this.syncMedia()},syncMedia:function(){this.$socket.sendObj({command:"sync_media",arguments:{}})}}}),j=O,$=(n("e486"),Object(m["a"])(j,x,w,!1,null,null,null));$.options.__file="PlaylistModal.vue";var z=$.exports,E={name:"PlayerBar",components:{PlaylistModal:z},props:{playerState:{type:Object,required:!0}}},G=E,I=(n("9f4d"),Object(m["a"])(G,_,S,!1,null,null,null));I.options.__file="PlayerBar.vue";var A=I.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-card",{staticClass:"mx-auto",style:{width:t.screenGrid.w+"px"},attrs:{id:"screenGrid"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("b-button-toolbar",{staticClass:"float-sm-right",attrs:{size:"sm"}},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.clientsModal",modifiers:{clientsModal:!0}}],staticStyle:{"margin-right":"5px"},attrs:{variant:"outline-secondary"}},[n("v-icon",{attrs:{name:"users"}})],1),t.editState.active?n("b-button-group",{staticClass:"mx-1"},[n("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.cancelEdit}},[n("v-icon",{attrs:{name:"times"}})],1),n("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.applyEdit}},[n("v-icon",{attrs:{name:"check"}})],1)],1):n("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.edit}},[n("v-icon",{attrs:{name:"edit"}})],1)],1)],1),n("div",{attrs:{id:"screenGridLayout"},on:{click:function(e){t.screenGridLayoutClicked(e)}}},[n("b-modal",{attrs:{id:"clientsModal","hide-footer":"",title:"Clients"}},[n("b-list-group",[n("b-button",{on:{click:t.syncMedia}},[t._v("Sync media")]),t._l(t.clients,function(e){return n("b-list-group-item",{key:e.ip,staticClass:"flex-column align-items-start",attrs:{variant:t.clientActive(e.ip)?"success":"danger"}},[n("div",[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[n("table",{staticClass:"clientTable"},[n("tr",[n("td",[t._v("IP:")]),n("td",{domProps:{textContent:t._s(e.ip)}})]),n("tr",[n("td",[t._v("Username:")]),n("td",{domProps:{textContent:t._s(e.username)}})]),n("tr",[n("td",[t._v("Media path:")]),n("td",{domProps:{textContent:t._s(e.media_path)}})])]),n("b-badge",{attrs:{variant:"info"}},[t._v("Age: "+t._s(e.age))])],1)])])})],2)],1),n("b-modal",{ref:"addModal",attrs:{"hide-footer":"",title:"Add screen for client"}},[n("div",{staticClass:"d-block text-center"},[n("b-form",{on:{submit:function(e){e.preventDefault(),t.addScreen()}}},[n("b-form-select",{attrs:{options:t.clientIpOptions,required:""},model:{value:t.editState.addScreenIp,callback:function(e){t.$set(t.editState,"addScreenIp",e)},expression:"editState.addScreenIp"}}),n("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Add screen")])],1)],1)]),n("grid-layout",{style:{height:t.screenGrid.h+"px",cursor:t.editState.active?"cell":"default"},attrs:{layout:t.screens,colNum:1280,rowHeight:1,maxRows:720,isDraggable:t.editState.active,isResizable:t.editState.active,isMirrored:!1,margin:[0,0],verticalCompact:!1,autoSize:!0,useCssTransforms:!0}},t._l(t.screens,function(e){return n("grid-item",{key:e.i,staticClass:"screen",style:{cursor:t.editState.active?"grabbing":"default"},attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i}},[n("b-card",{attrs:{footer:e.x+","+e.y+" ["+e.w+"x"+e.h+"]"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",{domProps:{textContent:t._s("Screen "+e.i)}}),n("b-button-toolbar",{staticClass:"float-sm-right"},[n("b-button-group",{staticClass:"mx-1",attrs:{size:"sm"}},[n("b-button",{attrs:{variant:t.clientActive(e.i)?"success":"danger"}},[n("v-icon",{attrs:{name:"plug"}})],1),t.editState.active?n("b-button",{attrs:{variant:"danger"},on:{click:function(n){t.removeScreen(e.i)}}},[n("v-icon",{attrs:{name:"trash-alt"}})],1):t._e()],1)],1)],1)])],1)}))],1)])},N=[],T=(n("ac6a"),n("7be8")),q=n.n(T),J={name:"ScreenGrid",components:{VueGridLayout:q.a},props:{clientConfig:{type:Object,required:!0},clients:{type:Array,required:!0}},data:function(){return{editState:{active:!1,addScreenIp:"",clickedPosition:{x:0,y:0}},screenGrid:{w:1280,h:720},screens:[]}},watch:{clientConfig:function(t){if(!this.editState.active)for(var e in this.screens=[],t)this.screens.push({i:e,x:t[e].videocrop_config.left,y:t[e].videocrop_config.top,w:1280-t[e].videocrop_config.left-t[e].videocrop_config.right,h:720-t[e].videocrop_config.top-t[e].videocrop_config.bottom})}},computed:{clientIpOptions:function(){var t=this,e=[];return this.clients.forEach(function(n){n.ip in t.clientConfig||e.push(n.ip)}),e}},methods:{edit:function(){this.editState.active=!0},cancelEdit:function(){this.editState.active=!1},applyEdit:function(){var t={};this.screens.forEach(function(e){t[e.i]={videocrop_config:{bottom:720-e.y-e.h,left:e.x,right:1280-e.x-e.w,top:e.y}}}),this.$socket.sendObj({command:"set_client_config",arguments:{config:t}}),this.editState.active=!1},addScreen:function(){this.screens.push({x:this.editState.clickedPosition.x,y:this.editState.clickedPosition.y,w:200,h:200,i:this.editState.addScreenIp}),this.$refs.addModal.hide()},removeScreen:function(t){this.screens=this.screens.filter(function(e){return e.i!==t})},screenGridLayoutClicked:function(t){this.editState.active&&"vue-grid-layout"==t.target.getAttribute("class")&&(this.$refs.addModal.show(),this.editState.clickedPosition.x=t.offsetX,this.editState.clickedPosition.y=t.offsetY)},clientActive:function(t){var e=!1;return this.clients.forEach(function(n){n.ip==t&&n.age<5&&(e=!0)}),e},syncMedia:function(){this.$socket.sendObj({command:"sync_media",arguments:{}})}}},L=J,R=(n("0e07"),Object(m["a"])(L,B,N,!1,null,null,null));R.options.__file="ScreenGrid.vue";var D=R.exports,V={name:"Player",components:{PlayerBar:A,ScreenGrid:D},created:function(){var t=this;this.$options.sockets.onmessage=function(e){return t.messageReceived(e)},this.$options.sockets.onopen=function(e){return t.newConnection(e)}},data:function(){return{serverState:{client_config:{},clients:[],player:{}}}},methods:{newConnection:function(t){console.log(t)},messageReceived:function(t){this.serverState=JSON.parse(t.data)},play:function(t){this.$socket.sendObj({command:"play",arguments:{filename:t}})}}},F=V,W=(n("6131"),Object(m["a"])(F,h,g,!1,null,null,null));W.options.__file="Player.vue";var H=W.exports,U={name:"app",components:{NavBar:y,Player:H}},X=U,Y=(n("034f"),Object(m["a"])(X,l,d,!1,null,null,null));Y.options.__file="App.vue";var K=Y.exports;a["default"].use(r["a"]),a["default"].use(i["a"]),a["default"].component("v-icon",o["a"]),a["default"].use(c.a,"ws://"+location.host+"/ws",{format:"json",reconnection:!0}),a["default"].config.productionTip=!1;var Q=[{path:"/",component:H}],Z=new r["a"]({routes:Q});new a["default"]({router:Z,render:function(t){return t(K)}}).$mount("#app")},6131:function(t,e,n){"use strict";var a=n("5004"),r=n.n(a);r.a},"82b7":function(t,e,n){},"9f4d":function(t,e,n){"use strict";var a=n("1ab3"),r=n.n(a);r.a},c21b:function(t,e,n){},cfd9:function(t,e,n){},e486:function(t,e,n){"use strict";var a=n("3c61"),r=n.n(a);r.a}});
//# sourceMappingURL=app.7e10ce6b.js.map